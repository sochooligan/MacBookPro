gdb å®‰è£…å’Œæˆæƒ

1. å®‰è£…
   brew install --force --build-from-source domq/gdb/gdb
        å‚è€ƒ: https://segmentfault.com/q/1010000004136334
   	è¯´æ˜ï¼šä½¿ç”¨å‘½ä»¤ brew install gdb å®‰è£…çš„gdbåœ¨è°ƒè¯•æ—¶ï¼Œç¬¬ä¸€æ¬¡ä¼šæŒ‚ä½ï¼Œä½¿ç”¨ä¸Šé¢
              çš„å‘½ä»¤å®‰è£…å¯ä»¥è§£å†³ã€‚
        bugçš„é“¾æ¥ï¼šhttps://sourceware.org/bugzilla/show_bug.cgi?id=24069
	  ...
    	  (gdb) run
    	  -> Starts program but then locks up. Could only terminate via ForceQuit
	  Taking a sample form the hanging gdb processes revealed that it hangs in darwin_decode_message at a wait4 call.
    	  ...

==> Downloading https://formulae.brew.sh/api/formula.jws.json
######################################################################### 100.0%
==> Fetching dependencies for domq/gdb/gdb: texinfo
==> Fetching texinfo
==> Downloading https://ghcr.io/v2/homebrew/core/texinfo/manifests/7.0.3_1
######################################################################### 100.0%
==> Downloading https://ghcr.io/v2/homebrew/core/texinfo/blobs/sha256:37d2829b2d
######################################################################### 100.0%
==> Fetching domq/gdb/gdb
==> Downloading https://ftp.gnu.org/gnu/gdb/gdb-13.1.tar.xz
######################################################################### 100.0%
==> Installing gdb from domq/gdb
==> Installing dependencies for domq/gdb/gdb: texinfo
==> Installing domq/gdb/gdb dependency: texinfo
==> Pouring texinfo--7.0.3_1.big_sur.bottle.tar.gz
==> Downloading https://formulae.brew.sh/api/cask.jws.json
######################################################################### 100.0%
ğŸº  /usr/local/Cellar/texinfo/7.0.3_1: 417 files, 9.1MB
==> Installing domq/gdb/gdb
==> Patching
==> ../configure --enable-targets=all --prefix=/usr/local/Cellar/gdb/13.1_1 --di
==> make
==> make install-gdb maybe-install-gdbserver
==> Caveats
gdb requires special privileges to access Mach ports.
You will need to codesign the binary. For instructions, see:

  https://sourceware.org/gdb/wiki/BuildingOnDarwin
==> Summary
ğŸº  /usr/local/Cellar/gdb/13.1_1: 67 files, 30.7MB, built in 12 minutes
==> Running `brew cleanup gdb`...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).
==> Caveats
==> gdb
gdb requires special privileges to access Mach ports.
You will need to codesign the binary. For instructions, see:

  https://sourceware.org/gdb/wiki/BuildingOnDarwin

2. codesign
   (1) åˆ›å»ºè¯ä¹¦
        å‚è€ƒ: https://gist.github.com/hlissner/898b7dfc0a3b63824a70e15cd0180154
       a. æ‰“å¼€Keychain Access
       b. åœ¨èœå•æ ï¼šKeychain Access > Certificate Assistant > Create a certificate...
       c. ç»™ä¸ªåå­—ï¼šå¦‚ gdbc
           Identity type: Self Signed Root
	   Certificate type: Code Signing
	   å‹¾é€‰ Let me override defaults
       d. æ—¶é—´æŒ‡å®šäº†ä¸€ä¸ªè¾ƒé•¿çš„å€¼ 7300 å¤©
       e. Continue until it prompts you for: "Specify a location for..."
           Set Keychain location to: System
       f. åˆ›å»ºcertificate å¹¶å…³é—­ assistant
       g. Keychain Access > System
           My Certificates > gdbc (åˆšåˆ›å»ºçš„) > åŒå‡»
	   åœ¨å¼¹å‡ºçš„çª—å£ï¼Œå±•å¼€ Trustï¼Œè®¾ç½® Code signing ä¸º always trust
       h. ç»ˆç«¯é‡Œæ‰§è¡Œå‘½ä»¤sudo killall taskgatedï¼ˆé‡å¯taskgatedï¼‰
   (2) æˆæƒ
        å‚è€ƒï¼šhttps://sourceware.org/gdb/wiki/BuildingOnDarwin
       a. åˆ›å»ºæ–‡ä»¶ gdb-entitlement.xml
            <?xml version="1.0" encoding="UTF-8"?>
            <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
            "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
            <plist version="1.0">
            <dict>
                <key>com.apple.security.cs.allow-jit</key>
                <true/>
                <key>com.apple.security.cs.allow-unsigned-executable-memory</key>
                <true/>
                <key>com.apple.security.cs.allow-dyld-environment-variables</key>
                <true/>
                <key>com.apple.security.cs.disable-library-validation</key>
                <true/>
                <key>com.apple.security.cs.disable-executable-page-protection</key>
                <true/>
                <key>com.apple.security.cs.debugger</key>
                <true/>
                <key>com.apple.security.get-task-allow</key>
                <true/>
            </dict>
            </plist>
       b. æ‰§è¡Œcodesignå‘½ä»¤
          codesign --entitlements gdb-entitlement.xml -fs gdbc $(which gdb)
